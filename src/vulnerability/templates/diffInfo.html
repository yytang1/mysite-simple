{% extends "vulnerability.html" %} 

{% block siderbar %} 
	list[0].classList.add('active') 
{% endblock %} 

{% block vulneContent %}
    {%if errors%} {%for error in errors%}
    <p style="color:red">{{error}}</p>
    {%endfor%} {%endif%}
	{%if info %}
		<div class="panel panel-primary">
			<div class="panel-heading">
				<h3 class="panel-title">Diff Information for {{info.cve.cve_id}}  {{info.software}}</h3>
			</div>
			<div class="panel-body">
			    {% if diffList %}
                <p class="text-info"><strong>Same diff with 
                    {% for diffinfo in diffList%}
                        {% ifequal diffinfo.cve info.cve%}
                        {% else %}
                        {{diffinfo.cve}} 
                        {% endifequal %}
                    {% endfor %}
                    </strong>
                </p>
                {% endif %}
                
				<div class="row">
				    <div class="col-md-4">
                        <strong>Software：</strong>
                        {% if info.software %}
                            {{info.software}}
                        {% else %}
                            unknown
                        {% endif %}
                    </div>
				    <div class="col-md-4">
                        <strong>Author：</strong>
                        {% if info.author %}
                            {{info.author}}
                        {% else %}
                            unknown
                        {% endif %}
                    </div>
                    <div class="col-md-4">
                        <strong>Published：</strong>
                        {% if info.publish_date %}
                            {{info.publish_date}}
                        {% else %}
                            unknown
                        {% endif %}
                    </div>
                </div>
                
				<div class="row">
    				<div class="col-md-12">
    				<strong>Diff Link：</strong><a href={{info.diff_link}}>{{info.diff_link}}</a>
    				</div>
				</div>
				
				<div class="row">
	                <div class="col-md-4">
	                    <strong>Download diff file：</strong>
	                        <a href="/download/?file={{info.diff_file}}"><i class="glyphicon glyphicon-file"></i> Source</a>
	                </div>
            	</div>
            	<div class="row">
                    <div class="col-md-12">
                        <strong>Diff Feature：</strong>
                        {% if diffFeatures %}
                            <table class="table table-bordered table-condensed table-striped">
			                    {% for diffFeature in diffFeatures%}
			                    <tr class="mytrB" style="height:35px;">
			                    	<td class="mylabel" style="width: 20%;"> @@ code segment {{diffFeature.num}}</td>
			                        <td>{% for feature in diffFeature.feature%}  
			                                <abbr title={{feature.feature.feature}}>{{feature.feature.id}}</abbr>
			                            {% endfor %}
			                        </td>
			                    </tr>
			                    {% endfor %}
                			</table>
                        {% else %}
                            unknown
                        {% endif %}
                        </div>
                </div>
			</div>
		</div>
		
		<div class="row">
		  <div class="col-md-4"><strong>Diff file：</strong></div>
		</div>
		{% if difftxt %}
			<pre>{{difftxt}}</pre> 
		{%else%}
		  None
		{% endif%} 
	{% endif %}
{% endblock %}