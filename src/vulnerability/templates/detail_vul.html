{% extends "vulnerability.html" %}

{% block siderbar %}
list[0].classList.add('active')
{% endblock %} 

{% block vulneContent %}
<h2 class="page-header">Vulnerability for：<strong>{{ query }}</strong></h2>
<div class="hero-unit">
	{%if errors%}
	   {%for error in errors%}
            <p style="color:red">{{error}}</p>
       {%endfor%} 
    {%endif%}
    
	{% if vulnerabilityDetail %}
	<p>CVE: {{vulnerabilityDetail.CVE.cve_id}}</p>
		<h3><strong>Base Information</strong></h3>
		<ul>
			<li><strong>CWE：</strong>{{ vulnerabilityDetail.CVE.cwe_id }}</li>
			<li><strong>Type：</strong>{{ vulnerabilityDetail.CVE.vuln_type }}</li>
			<li><strong>Description：</strong>{{ vulnerabilityDetail.CVE.description }}</li>
			<li><strong>Submitter：</strong>{{ vulnerabilityDetail.CVE.user }}</li>
			<li><strong>Updatetime：</strong>{{ vulnerabilityDetail.CVE.update_date }}</li>
			{% if vulnerabilityDetail.CVSS %}
              {% for cvss in vulnerabilityDetail.CVSS%}
             <h4> CVSS Severity (version {{cvss.version}})：</h4>
             		 <!--<li class="divider"></li>-->  
                      <li><strong>CVSS v2 Base Score：</strong>{{cvss.baseScore}}</li>
                      <li><strong>Impact Subscore：</strong>{{cvss.impactSubscore}}</li>
                      <li><strong>Exploitability Subscore：</strong>{{cvss.exploitabilitySubscore}}</li>
                      <h4>CVSS Version 2 Metrics:</h4>
                      <li><strong>Access Vector：</strong>{{cvss.accessVector}}</li>
                      <li><strong>Access Complexity：</strong>{{cvss.accessComplexity}}</li>
                      <li><strong>Authentication：</strong>{{cvss.authentication}}</li>
                      <li><strong>Impact Type：</strong>{{cvss.impactType}}</li>
              {% endfor %}
            {% endif %}
		</ul>
		
		{%if vulnerabilityDetail.INFO %}
			{% for info in vulnerabilityDetail.INFO %}
			    {% if info.diff_link %}
			       {% ifequal forloop.counter 1%}
			       <h3><strong><a href="/diffInfo/?q={{info.cve.cve_id}}&info={{info.id}}">Diff Information</strong></a></h3>
			       {% endifequal %}  
				<ul>
					<li><strong>Diff Link：</strong><a href={{info.diff_link}}>{{info.diff_link}}</a></li>
					<li><strong>Diff Feature：</strong>
    					{% for feature in info.feature%}
    					   <abbr title={{feature.feature.feature}}>{{feature.feature.id}}</abbr>   
    					{% endfor %}
    				</li>
					<li><strong>Is Checked：</strong>{{info.check_flag}}</li>
				</ul>
				<ul class="list-unstyled">
				    <li class="divider"></li>
				</ul>
				{% endif %}
			{%endfor%}
		{%endif%}
		
		
		{% if vulnerabilityDetail.REUSES %}
		  <h3><strong>Code Reuse Information</strong></h3>
		   {% for reuse in vulnerabilityDetail.REUSES %}
		      <ul class="list-inline">
                  <li><strong>Reuse {{forloop.counter}}</strong></li>
                  <li>{{reuse.info_id.software}} {{reuse.version}}</li>
                  <li>{{reuse.patch_func}}</li>
                  <li> in </li>
                  <li>{{reuse.patch_file}}</li>
              </ul>
		      <ul>
		          <li><strong>Feature：</strong>
        		          {% if reuse.feature %}
                              {% for feature in reuse.feature%}
                               {{feature.feature.id}}
                               {% endfor %}
                          {% else %}
                               unknown
                          {% endif %}
		          </li>
		          <li><strong>Download ：</strong>
		          <a href="/download/?info={{reuse.info_id.id}}&func={{reuse.patch_func}}&version={{reuse.version}}"><i class="glyphicon glyphicon-file"></i>file</a>
		          </li>
			      <li class="text-info" data-toggle="collapse" href="#demo{{forloop.counter}}"><strong>Code Show(click)</strong></li>
		          <li id="demo{{forloop.counter}}" class="collapse in"><pre>{{reuse.code}}</pre></li>
		      </ul>
		       	
		   {% endfor %}
		{% endif %}
		
		{% if vulnerabilityDetail.EXPLOITS %}
		  <h3><strong>Exploits Information</strong></h3>
		      {% for exploit in vulnerabilityDetail.EXPLOITS %}
		          <p><strong>Exploits {{forloop.counter}}</strong></p>
		          <ul>
		              <li><strong>EDB id：</strong>{{exploit.edb_id}}</li>
		              <li><strong>EDB Link：</strong><a href={{exploit.link}}>{{exploit.link}}</a></li>
		              <li><strong>Author：</strong>{{exploit.author}}</li>
		              <li><strong>Publish Date：</strong>{{exploit.publish_date}}</li>
		          </ul>
		      {% endfor%}
        {% endif %}
	{% endif %} 
 </div>
{% endblock %} 
