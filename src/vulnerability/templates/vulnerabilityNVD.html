{% extends "vulnerability.html" %}

{% block siderbar %} 
list[0].classList.add('active')
{% endblock %} 

{% block vulneContent %}
<h2 class="page-header">Vulnerabilities List:</h2> {%if errors%} {%for error in errors%}
	<p style="color:red">{{error}}</p>
	{%endfor%} {%endif%}
	<p>There are <strong>{{pageInfo.sum}} </strong>Vulnerabilities records.</p>
	<p>Displaying matches {{pageInfo.curIndex}} through {{pageInfo.endIndex}}.</p>

	<div class="table-responsive">
		<table class="table table-striped">
		{%if vulnerabilities%}
			<thead>
				<tr>
					<th style="width: 15%;">CVE</th>
					<th style="width: 10%;">CWE</th>
					<th style="width: 10%;">CVSS Severity</th>
					<th style="width: 50%;">Summary</th>
					<th style="width: 5%;">Exploits</th>
					<th style="width: 10%;">UpdateTime</th>
				</tr>
			</thead>
			<tbody>
				 {% for vulnerability in vulnerabilities %}
				<tr>
					<td><a href="/detail/?q={{vulnerability.cve_id}}" />{{ vulnerability.cve_id }}</td>
					<td>{{vulnerability.cwe_id}}</td>
					<td>{{ vulnerability.cvss_id}}</td>
					<td>
					<p style="width: 550px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">{{ vulnerability.description }}</p>
					</td>
					<td>{{ vulnerability.exploits }}</td>
					<td>{{ vulnerability.update_date }}</td>
				</tr>
				{%endfor%}
			</tbody>
		{%endif%}
		</table>
	</div>
	<nav class="text-center">
  <ul class="pagination pagination-sm">
    <li>
      <a href="/vulnerability/NVDlist/?startIndex=0" aria-label="Previous">
        <span aria-hidden="true">&laquo;</span>
      </a>
    </li>   
    {%for pageNum in pageInfo.pages%}
        {%ifequal pageNum pageInfo.curPageNum%}
            <li class="active"><a href="/vulnerability/NVDlist/?startIndex={{pageInfo.getPageIndex}}&firstPageNum={{pageInfo.firstPageNum}}">{{pageNum}}</a></li>
        {%else%}
            <li><a href="/vulnerability/NVDlist/?startIndex={{pageInfo.getPageIndex}}&firstPageNum={{pageInfo.firstPageNum}}">{{pageNum}}</a></li>
        {%endifequal%}
    {%endfor%}
    <li>
      <a href="/vulnerability/NVDlist/?startIndex={{pageInfo.lastPageIndex}}" aria-label="Next">
        <span aria-hidden="true">&raquo;</span>
      </a>
    </li>
  </ul>
</nav>
{% endblock %}